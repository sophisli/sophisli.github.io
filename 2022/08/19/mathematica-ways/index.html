<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;auto&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/world.png"><link rel="icon" href="/img/world.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content=""><meta name="author" content="Lee"><meta name="keywords" content=""><title>Mathematica一种实现多项式合并化简的方法 - 知梧</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"sophisli.github.io",root:"/",version:"1.8.9",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:"§"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},copy_btn:!0,image_zoom:{enable:!0},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,onlypost:!1},web_analytics:{enable:!1,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null}}}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="知梧" type="application/atom+xml"></head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>知梧</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item"><a class="nav-link" href="/gallery/"><i class="iconfont icon-link-fill"></i> gallery</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" href="javascript:">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(/img/gu.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="Mathematica一种实现多项式合并化简的方法"></span><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-08-19 15:51" pubdate>2022年8月19日 下午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 648 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 8 分钟</span></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">Mathematica一种实现多项式合并化简的方法</h1><div class="markdown-body"><h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><p>当符号计算多项式涉及叠波、频谱分析等的时候，对如下多项式的简化</p><script type="math/tex;mode=display">f(x,a,b,c,d,\cdots)=a e^{-i(bx+d^2)}+a b c e^{-i(bx+d^2x^2+fc^2)}+\cdots+\frac{a^2b^2}{2c+b+d^3} e^{-i(bx+d^2)}</script><p>mathematica的Simplify或factor函数实现的形式并不是我们想要的，因为在计算机并不能识别你输入的公式符号变量的权重，它对所有变量一视同仁，导致最后的结果只是形式上的整理。实际上我们需要将多项式相同指数项选择性的合并操作，例如</p><script type="math/tex;mode=display">f(x,a,b,c,d,\cdots)=(a b c+\cdots) e^{-i(bx+d^2x^2+fc^2)}+\cdots+\left(a+\frac{a^2b^2}{2c+b+d^3}+\cdots\right) e^{-i(bx+d^2)}</script><p>而实际情况下在涉及复杂多项式的对应简化，人工手动选择逐一合并是不现实的，所以本文提出一个解决的方案。</p><h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><p>核心的函数是PotionIndex和映射定义<a href="#1"><sup>1</sup></a>。</p><p>首先将多项式逐项展开成列表形式：<br></p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">p1expand</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">Expand</span><span class="hljs-punctuation">[</span><span class="hljs-variable">p1</span><span class="hljs-punctuation">]</span><span class="hljs-comment">(* p1是如上需要被展开的多项式 *)</span><br><span class="hljs-variable">apply</span><span class="hljs-punctuation">[</span><span class="hljs-variable">list</span><span class="hljs-operator">,</span><span class="hljs-variable">p1expand</span><span class="hljs-punctuation">]</span>       <br></code></pre></td></tr></table></figure><br>有了以上的逐项展开式，我们可以分别对多项式的子项进行操作，由此，可以调用FirstCase函数并创建映射关系，提取列表的每一项的系数和指数信息，并将指数转换成系数矩阵的形式：<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">coefflist</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">FirstCase</span><span class="hljs-punctuation">[</span><span class="hljs-type">#</span><span class="hljs-operator">,</span> <span class="hljs-built_in">Exp</span><span class="hljs-punctuation">[</span><span class="hljs-type">b__</span><span class="hljs-punctuation">]</span> <span class="hljs-type">a_</span><span class="hljs-operator">.</span> <span class="hljs-operator">:&gt;</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-variable">a</span><span class="hljs-operator">,</span> <span class="hljs-built_in">CoefficientList</span><span class="hljs-punctuation">[</span> <span class="hljs-variable">b</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-variable">x</span><span class="hljs-operator">,</span><span class="hljs-variable">c</span><span class="hljs-punctuation">&#125;</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-number">0</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&amp;</span> <span class="hljs-operator">/@</span> <span class="hljs-variable">p1list</span> <span class="hljs-operator">;</span><span class="hljs-comment">(*注意，这里e指数部分的多项式变量是x和c，只是简单示例，类似地，可以定义任意的底数*)</span><br></code></pre></td></tr></table></figure><br>由于实际的多项式指数部分的可能只有常系数，所以转换来的系数矩阵可能是空集，因此我们需要把这部分空集去掉。<br>这里一开始要确定空集的位置：<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">nullindex</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">Position</span><span class="hljs-punctuation">[</span><span class="hljs-variable">coefflist</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure><br>由此获得coefflist去除空集后的列表，进而得到去除空集的元素位置：：<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">withoutnull</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">Cases</span><span class="hljs-punctuation">[</span><span class="hljs-variable">coefflist</span><span class="hljs-operator">,</span> <span class="hljs-built_in">Except</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-operator">;</span><br><span class="hljs-variable">index</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">PositionIndex</span><span class="hljs-punctuation">[</span><span class="hljs-variable">withoutnull</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-operator">;;</span> <span class="hljs-operator">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure><br>这里使用List结构和循环结构，分别计算系数项，e指数项以及常数项：<p></p><p>系数项：<br></p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">coeff</span><span class="hljs-operator">=</span><span class="hljs-built_in">Table</span><span class="hljs-punctuation">[</span><span class="hljs-built_in">Simplify</span><span class="hljs-punctuation">[</span><span class="hljs-variable">withoutnull</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-variable">index</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-variable">i</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">//</span> <span class="hljs-built_in">Total</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-variable">i</span><span class="hljs-operator">,</span> <span class="hljs-number">1</span><span class="hljs-operator">,</span>  <span class="hljs-built_in">Length</span><span class="hljs-punctuation">[</span><span class="hljs-variable">index</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><span class="hljs-operator">;</span><br></code></pre></td></tr></table></figure><br>指数项：<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">expon</span><span class="hljs-operator">=</span><span class="hljs-built_in">Table</span><span class="hljs-punctuation">[</span><span class="hljs-built_in">Simplify</span><span class="hljs-punctuation">[</span><span class="hljs-variable">Internal</span><span class="hljs-operator">`</span><span class="hljs-variable">FromCoefficientList</span><span class="hljs-punctuation">[</span> <span class="hljs-variable">withoutnull</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-variable">waveindex</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-variable">i</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-variable">x</span><span class="hljs-operator">,</span><span class="hljs-variable">c</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-operator">//</span> <span class="hljs-built_in">Exp</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-variable">i</span><span class="hljs-operator">,</span> <span class="hljs-number">1</span><span class="hljs-operator">,</span> <span class="hljs-built_in">Length</span><span class="hljs-punctuation">[</span><span class="hljs-variable">index</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure><br>常数项：<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">ct</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-operator">;</span><br><span class="hljs-built_in">Do</span><span class="hljs-punctuation">[</span><span class="hljs-variable">rt</span> <span class="hljs-operator">=</span> <span class="hljs-variable">ct</span> <span class="hljs-operator">+</span> <span class="hljs-variable">p1list</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-variable">nullindex</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-variable">i</span><span class="hljs-operator">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-variable">i</span><span class="hljs-operator">,</span> <span class="hljs-built_in">Length</span><span class="hljs-punctuation">[</span><span class="hljs-variable">nullindex</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span>；<br></code></pre></td></tr></table></figure><br>最后只需要<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">poly</span><span class="hljs-operator">=</span><span class="hljs-variable">coeff</span><span class="hljs-operator">.</span><span class="hljs-variable">expon</span><span class="hljs-operator">+</span><span class="hljs-variable">rt</span><span class="hljs-operator">;</span><br></code></pre></td></tr></table></figure><br>即可得到最后的归并形式。<p></p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><span id="1">1. 这是小憩片刻的思路</span></p></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/symbol-calculation/">symbol calculation</a> <a class="hover-with-bg" href="/categories/symbol-calculation/mathematica/">mathematica</a></div></div><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p><div class="post-prevnext"><article class="post-prev col-6"><a href="/2022/09/01/noncommutativealgebra/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">mathematica实现非对易代数计算</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2022/08/08/machinelearning/"><span class="hidden-mobile">machine learning note</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments" lazyload><div id="gitalk-container"></div><script type="text/javascript">Fluid.utils.lazyComments("gitalk-container",function(){Fluid.utils.createCssLink("/css/gitalk.css"),Fluid.utils.createScript("https://cdn.jsdelivr.net/npm/gitalk@1.7.0/dist/gitalk.min.js",function(){new Gitalk({clientID:"b45abf2bb1a9547df523",clientSecret:"32619621610193bba7bd00683f90396de96d54d2",repo:"liblogtalk",owner:"sophisli",admin:["sophisli"],id:"c47d5d139dded25053bc3be812f42a22",language:"zh-CN",labels:["Gitalk"],perPage:10,pagerDirection:"last",createIssueManually:!0,distractionFreeMode:!1,proxy:"https://shielded-brushlands-08810.herokuapp.com/https://github.com/login/oauth/access_token"}).render("gitalk-container")})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div></footer><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"></script><script src="/js/debouncer.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script><script>!function(t){(0,Fluid.plugins.typing)(t.getElementById("subtitle").title)}((window,document))</script><script src="/js/local-search.js"></script><script>$("#local-search-input").on("click",function(){searchFunc("/local-search.xml","local-search-input","local-search-result")}),$("#modalSearch").on("shown.bs.modal",function(){$("#local-search-input").focus()})</script><script>MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };</script><script async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-svg.js"></script><script src="/js/boot.js"></script></body></html>